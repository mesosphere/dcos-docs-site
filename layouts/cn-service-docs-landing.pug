- var paths = path.split('/')
- var currentPath = '/' + path
- var mesosDocs = hierarchy.children.filter(child => child.id == 'mesosphere')[0]
- var dcosDocs = mesosDocs.children.filter(child => child.id == 'dcos')[0]
- var cnDocs = dcosDocs.children.filter(child => child.id == 'cn')[0]
- var items = cnDocs.children.filter(child => child.id == 'services')[0]
//- - var items = svDocs.children

//- - var items = hierarchy.children.find(el => el.path === `/dcos/cn`).children.find(el => el.path === `/cn/services`)
- var productPages = hierarchy.find('menus').filter(page => page.menus.indexOf('dcos-cn-header') != -1)
- var pages = productPages.sort((a, b) => a.menuWeight - b.menuWeight)
- var headerItems = hierarchy.find('menus').filter(page => page.menus.indexOf('landing-header') != -1)
- var headerSphereItems = headerItems.filter(page => page.id != 'mesosphere')
- var semverService = /^(v|)[0-9](.*)/
- var isChinese = paths[2] == 'cn'
- var isDCOS = paths[1] == 'dcos'

mixin renderGridToc()
  div(class='grid-toc')
    each val, index in items.children
      if val.menuWeight != -1
        if val.children
          each childVal, childIndex in val.children
            if semverService.test(childVal.id) && childVal.menuWeight != -1
              - versioned = true
              - childVal.title = val.title
              - val = childVal
              - break
        div(class='grid-toc__item')
          h2(class='grid-toc__title')
            a(href=val.path)!= val.title
          - var displayExcerpt = (val.excerpt.length > 100) ? val.excerpt.substring(0, 100) + '…' : val.excerpt
          p(class='grid-toc__desc')!= displayExcerpt
          if val.children
            ul(class='grid-toc__list')
              for item in val.children.slice(0, 5)
                li(class='grid-toc__list-item')
                  a(href=item.path, class='grid-toc__link')!= item.title
              if val.children.length > 5
                li(class='grid-toc__list-item')
                  a(href=val.path, class='grid-toc__link grid-toc__link--all') View All
                    img(class='grid-toc__link--all__arrow', src='/assets/right-arrow.svg')

doctype html
html(lang='en')
  head
    include partials/head.pug
  body(class='landing landing--services')
    div(class='layout')
      div(role='main', class='layout__content')
        include partials/header/dcos-cn-header.pug
        div(class='landing__hero')
          h1(class='landing__title') DC/OS 服务文档
        div(class='landing__container')
          +renderGridToc()
        footer(class='landing__footer')
          div(class='landing__footer__container')
            a(class='landing__footer__logo__link', href='https://d2iq.com/')
              img(class='landing__footer__logo', src='/assets/D2IQ_Logotype_Color_Positive.png', alt='D2iQ')
            div(class='landing__footer__menu')
              a(href='https://d2iq.com/terms/') Terms of Service
              a(href='https://d2iq.com/privacy/') Privacy Policy
            a(class='landing__footer__copyright', href='https://d2iq.com/')!= copyright
    script(src='https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js')
    script(src='https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js')
    include partials/scripts.pug
